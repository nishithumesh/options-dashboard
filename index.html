<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NIFTY / BANKNIFTY Auto Tracker</title>
<style>
body {
font-family: Arial, sans-serif;
margin: 20px;
background: #fff;
color: #111;
}
h2 {
margin-top: 30px;
text-align: center;
border-bottom: 2px solid #ddd;
padding-bottom: 6px;
}
table {
width: 100%;
border-collapse: collapse;
margin-top: 10px;
}
th, td {
border: 1px solid #ccc;
padding: 6px;
text-align: center;
}
th {
background-color: #f3f3f3;
}
.updated {
text-align: center;
font-size: 12px;
color: gray;
margin-top: 6px;
}
</style>
</head>
<body>
<h2>NIFTY Option Chain</h2>
<table id="niftyTable"><thead></thead><tbody></tbody></table>

<h2>BANKNIFTY Option Chain</h2>
<table id="bankniftyTable"><thead></thead><tbody></tbody></table>

<div class="updated" id="updateTime"></div>

<script>
const sheetBase = "https://opensheet.elk.sh/1nKbdlZUVFX-zegMiYf12tWsYN4810DOedJ6t6V-ft3L/";

async function loadSheetData(sheetName, tableId) {
try {
const res = await fetch(sheetBase + sheetName + "?t=" + Date.now()); // prevent caching
const data = await res.json();
const table = document.getElementById(tableId);
const thead = table.querySelector("thead");
const tbody = table.querySelector("tbody");

if (!data.length) {
thead.innerHTML = "";
tbody.innerHTML = "<tr><td>No data found</td></tr>";
return;
}

// Table headers
const headers = Object.keys(data[0]);
thead.innerHTML = "<tr>" + headers.map(h => `<th>${h}</th>`).join("") + "</tr>";

// Table rows
tbody.innerHTML = data.map(row =>
"<tr>" + headers.map(h => `<td>${row[h] || ""}</td>`).join("") + "</tr>"
).join("");
} catch (err) {
document.getElementById(tableId).innerHTML =
"<tr><td>Error loading data</td></tr>";
}
}

async function autoUpdate() {
await loadSheetData("NIFTY", "niftyTable");
await loadSheetData("BANKNIFTY", "bankniftyTable");
document.getElementById("updateTime").textContent =
"Last updated: " + new Date().toLocaleTimeString();
}

// Auto update every 20 seconds
autoUpdate();
setInterval(autoUpdate, 20000);
</script>
</body>
</html>
