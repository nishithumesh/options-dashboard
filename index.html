<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NIFTY / BANKNIFTY Auto Tracker</title>
<style>
body {
font-family: Arial, sans-serif;
margin: 20px;
background: #fff;
color: #111;
}
h2 {
margin-top: 30px;
text-align: center;
border-bottom: 2px solid #ddd;
padding-bottom: 6px;
}
table {
width: 100%;
border-collapse: collapse;
margin-top: 10px;
}
th, td {
border: 1px solid #ccc;
padding: 6px;
text-align: center;
}
th {
background-color: #f3f3f3;
}
.updated {
text-align: center;
font-size: 12px;
color: gray;
margin-top: 6px;
}
</style>
</head>
<body>
<h2>NIFTY Option Chain</h2>
<table id="niftyTable"><thead></thead><tbody></tbody></table>

<h2>BANKNIFTY Option Chain</h2>
<table id="bankniftyTable"><thead></thead><tbody></tbody></table>

<div class="updated" id="updateTime"></div>

<script>
async function fetchSheetData() {
const url = 'https://opensheet.elk.sh/1nKbdlZUVFX-zegMiYf12tWsYN4810DOedJ6t6V-ft3L/NIFTY';
try {
const res = await fetch(url);
const data = await res.json();

const container = document.getElementById('nifty-data');
container.innerHTML = ''; // clear old

if (!data.length) {
container.innerHTML = '<tr><td colspan="10">No data found</td></tr>';
return;
}

// build table headers dynamically
const headers = Object.keys(data[0]);
const headerRow = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>';
container.innerHTML += headerRow;

// add each row
data.forEach(row => {
const rowHTML = '<tr>' + headers.map(h => `<td>${row[h] || ''}</td>`).join('') + '</tr>';
container.innerHTML += rowHTML;
});

document.getElementById('last-update').textContent =
'Last updated: ' + new Date().toLocaleTimeString();
} catch (err) {
console.error(err);
document.getElementById('nifty-data').innerHTML =
'<tr><td colspan="10">Error loading data</td></tr>';
}
}

// initial + periodic refresh
fetchSheetData();
setInterval(fetchSheetData, 20000);
</script>
</body>
</html>
